!function(e,s){"function"==typeof define&&define.amd?define(["exports"],s):"undefined"!=typeof exports?s(exports):(s(s={}),e.ifrStorage=s)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.stop=function(){c.forEach(function(e){window.removeEventListener("message",e)}),window.removeEventListener("message",s)};const c=[];const s=function(e){try{var s=JSON.parse(e.data);"iframeStorage.init"===s.type&&function(a,n){const i={type:"iframeStorage.sync",localStorage:{},sessionStorage:{}},r=function(e){if(e.source===a)if(e.source.parent)try{var s=JSON.parse(e.data);if("iframeStorage"===s.name){const o=i[s.storage];switch(s.method){case"setItem":o[s.key]=s.value;break;case"removeItem":delete o[s.key];break;case"clear":Object.keys(o).forEach(function(e){delete o[e]})}n.scope&&(window[s.storage][n.scope]=JSON.stringify(o))}else"iframeStorage.sync"===s.type&&a.postMessage(JSON.stringify(i),"*")}catch(e){}else{var t=c.indexOf(r);t!==-r&&(window.removeEventListener("message",r),c.splice(t,1))}};if(c.push(r),window.addEventListener("message",r),n.localStorage)if(n.scope)try{Object.assign(i.localStorage,JSON.parse(localStorage[n.scope]))}catch(e){}else i.localStorage=localStorage;if(n.sessionStorage)if(n.scope)try{Object.assign(i.sessionStorage,JSON.parse(sessionStorage[n.scope]))}catch(e){}else i.sessionStorage=sessionStorage;a.postMessage(JSON.stringify(i),"*")}(e.source,s)}catch(e){}};window.addEventListener("message",s)});